<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pizza App â€“ V6.4 Fun Pizza</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Pizza App">

<style>
:root{
  --bg:#f4f4f6;
  --card:#ffffff;
  --accent1:#ff7a18;
  --accent2:#ff3b30;
  --text:#111;
  --muted:#666;
}
body.dark{
  --bg:#0f0f12;
  --card:#1c1c1e;
  --accent1:#ff9f0a;
  --accent2:#ff453a;
  --text:#f2f2f7;
  --muted:#aaa;
}
*{box-sizing:border-box}
body{
  margin:0;padding:16px;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:var(--bg);color:var(--text)
}
.container{max-width:440px;margin:auto}
h1{text-align:center;margin-bottom:4px}
.subtitle{text-align:center;color:var(--muted);margin-bottom:16px;font-size:14px}

.card{
  background:var(--card);
  border-radius:18px;
  padding:16px;
  margin-bottom:14px;
  box-shadow:0 8px 20px rgba(0,0,0,.15);
  animation:pop .35s ease;
}
@keyframes pop{from{transform:scale(.96);opacity:0}to{transform:scale(1);opacity:1}}

.section-title{
  font-size:15px;font-weight:800;margin-bottom:10px;
  display:flex;align-items:center;gap:6px
}

label{font-size:14px;font-weight:600;display:block;margin-bottom:4px}
input,select{
  width:100%;padding:12px;border-radius:12px;
  border:1px solid #444;font-size:15px;
  margin-bottom:10px;background:var(--card);color:var(--text)
}
input[type=range]{padding:0}

.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}

.pm{display:flex;align-items:center;gap:6px}
.pm button{
  width:36px;height:36px;border:none;border-radius:10px;
  background:linear-gradient(135deg,var(--accent1),var(--accent2));
  color:#fff;font-size:18px;font-weight:900
}

button.main{
  width:100%;padding:15px;border:none;border-radius:18px;
  font-size:17px;font-weight:800;color:#fff;
  background:linear-gradient(135deg,var(--accent1),var(--accent2));
  box-shadow:0 8px 18px rgba(255,59,48,.45);
  transition:transform .15s
}
button.main:active{transform:scale(.97)}

.toggle{text-align:right;font-size:13px;cursor:pointer;color:var(--muted)}

pre{
  background:#000;color:#0f0;padding:14px;border-radius:14px;
  font-size:13px;white-space:pre-wrap;
  animation:fade .4s ease
}
@keyframes fade{from{opacity:0}to{opacity:1}}

.small{font-size:13px;color:var(--muted)}
.hint{font-size:13px;color:var(--muted);margin-top:-6px}
.hidden{display:none}
</style>
</head>

<body>
<div class="container">

<div class="toggle" onclick="toggleDark()">ğŸŒ™ / â˜€ï¸ Mode</div>

<h1>ğŸ• Pizza App</h1>
<div class="subtitle">V6.4 Â· Fun Pizza â€” Â« Ã€ moment donnÃ©â€¦ faut une bonne pÃ¢te Â»</div>

<!-- PROFIL -->
<div class="card">
<div class="section-title">ğŸ• Profil Pizza</div>
<select id="profil" onchange="appliquerProfil()">
<option value="maison">ğŸ  Maison</option>
<option value="napo">ğŸ‡®ğŸ‡¹ Napolitaine</option>
<option value="romaine">ğŸ• Romaine</option>
<option value="teglia">ğŸŸ« Teglia</option>
</select>
</div>

<!-- EMPÃ‚TEMENT -->
<div class="card">
<div class="section-title">ğŸ¥£ EmpÃ¢tement</div>
<select id="empatement" onchange="updateEmpatement()">
<option value="direct">Direct</option>
<option value="biga">Biga</option>
<option value="poolish">Poolish</option>
</select>

<div id="bigaOptions" class="hidden">
<label>% farine en biga</label>
<input type="number" id="bigaPct" value="50" min="30" max="70">

<label>Levure en biga</label>
<select id="bigaLevureMode">
<option value="j1">100 % en J-1</option>
<option value="split">J-1 / J0 (rafraÃ®chi)</option>
</select>

<div class="small">ğŸ’¡ Biga = 45 % eau, arÃ´mes + force</div>
</div>
</div>

<!-- FARINE -->
<div class="card">
<div class="section-title">ğŸ Farine</div>
<select id="farine" onchange="changerFarine()"></select>
<div id="farineInfo" class="small"></div>
</div>

<!-- HYDRATATION -->
<div class="card">
<div class="section-title">ğŸ’§ Hydratation</div>
<input type="number" id="hydratation" min="55" max="80">
<input type="range" id="hydraSlider" min="55" max="80">
<div id="hydraHint" class="hint"></div>

<label>ğŸ• Pizzas</label>
<div class="pm">
<button onclick="step('pizzas',-1)">âˆ’</button>
<input id="pizzas" value="4">
<button onclick="step('pizzas',1)">+</button>
</div>

<label>âš–ï¸ PÃ¢ton (g)</label>
<div class="pm">
<button onclick="step('poids',-10)">âˆ’</button>
<input id="poids" value="280">
<button onclick="step('poids',10)">+</button>
</div>
</div>

<!-- SEL -->
<div class="card">
<div class="section-title">ğŸ§‚ Sel</div>
<input type="number" id="selPct" value="2.8" step="0.1" min="2.5" max="3">
</div>

<!-- FERMENTATION -->
<div class="card">
<div class="section-title">â±ï¸ Fermentation</div>

<label>TA 1 (h / Â°C)</label>
<div class="grid-2">
<div class="pm"><button onclick="step('ta1h',-1)">âˆ’</button><input id="ta1h" value="4"><button onclick="step('ta1h',1)">+</button></div>
<div class="pm"><button onclick="step('ta1t',-1)">âˆ’</button><input id="ta1t" value="20"><button onclick="step('ta1t',1)">+</button></div>
</div>

<label>TC (h / Â°C)</label>
<div class="grid-2">
<div class="pm"><button onclick="step('tcH',-1)">âˆ’</button><input id="tcH" value="16"><button onclick="step('tcH',1)">+</button></div>
<div class="pm"><button onclick="step('tcT',-1)">âˆ’</button><input id="tcT" value="4"><button onclick="step('tcT',1)">+</button></div>
</div>

<label>TA 2 (h / Â°C)</label>
<div class="grid-2">
<div class="pm"><button onclick="step('ta2h',-1)">âˆ’</button><input id="ta2h" value="4"><button onclick="step('ta2h',1)">+</button></div>
<div class="pm"><button onclick="step('ta2t',-1)">âˆ’</button><input id="ta2t" value="20"><button onclick="step('ta2t',1)">+</button></div>
</div>
</div>

<!-- LEVURE & FOUR -->
<div class="card">
<div class="section-title">ğŸ”¥ Levure & Four</div>
<select id="typeLevure">
<option value="fraiche">Levure fraÃ®che</option>
<option value="seche">Levure sÃ¨che</option>
</select>
<select id="modeFour"></select>
<div id="fourHint" class="hint"></div>
</div>

<button class="main" onclick="calculer()">ğŸ• Calculer</button>
<button class="main" onclick="exportPDF()">ğŸ“„ Export PDF</button>

<div class="card"><pre id="fiche"></pre></div>

<!-- GLOSSAIRE -->
<div class="card">
<div class="section-title">ğŸ“š Glossaire</div>
<p class="small"><b>Biga</b> : prÃ©ferment ferme (â‰ˆ45 % eau).</p>
<p class="small"><b>Poolish</b> : prÃ©ferment liquide (100 % eau).</p>
<p class="small"><b>RafraÃ®chi</b> : ajout final aprÃ¨s prÃ©ferment.</p>
<p class="small"><b>TA</b> : tempÃ©rature ambiante.</p>
<p class="small"><b>TC</b> : tempÃ©rature contrÃ´lÃ©e (frigo).</p>
<p class="small"><b>Hydratation</b> : eau / farine (%).</p>
</div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
if(localStorage.getItem("dark")==="1") document.body.classList.add("dark");
function toggleDark(){document.body.classList.toggle("dark");localStorage.setItem("dark",document.body.classList.contains("dark")?"1":"0");}
function step(id,v){const i=document.getElementById(id);i.value=Math.max(0,(+i.value||0)+v);}

/* FARINES */
const farines={
caputo_pizzeria:{nom:"Caputo Pizzeria",w:"W260",abs:"55â€“60%",hydra:60,coef:1},
caputo_cuoco:{nom:"Caputo Cuoco",w:"W300",abs:"60â€“62%",hydra:62,coef:.85},
caputo_nuvola:{nom:"Caputo Nuvola",w:"W280",abs:"63â€“65%",hydra:65,coef:.9},
caputo_supernuvola:{nom:"Caputo Super Nuvola",w:"W320",abs:"68â€“70%",hydra:68,coef:.8},
petra_0102:{nom:"Petra 0102 HP",w:"W300",abs:"63â€“65%",hydra:64,coef:.9},
petra_integrale:{nom:"Petra Integrale",w:"W280",abs:"65â€“70%",hydra:70,coef:1.1},
denti_anima:{nom:"Denti Anima Verace",w:"W280",abs:"60â€“62%",hydra:62,coef:.95}
};

/* FOURS */
const fours={
bois:{label:"ğŸ”¥ Bois",hydra:+2,temp:"430â€“480 Â°C",txt:"Chaleur trÃ¨s vive"},
elec:{label:"âš¡ Ã‰lectrique",hydra:0,temp:"420â€“450 Â°C",txt:"Chaleur stable"},
ooni:{label:"ğŸ”¥ Gaz Ooni",hydra:+1,temp:"420â€“500 Â°C",txt:"Chaleur forte"}
};

Object.keys(farines).forEach(k=>{let o=document.createElement("option");o.value=k;o.textContent=farines[k].nom;farine.appendChild(o)});
Object.keys(fours).forEach(k=>{let o=document.createElement("option");o.value=k;o.textContent=fours[k].label;modeFour.appendChild(o)});

function changerFarine(){
const f=farines[farine.value];
hydratation.value=f.hydra;
hydraSlider.value=f.hydra;
updateHydraHint(f.hydra);
farineInfo.innerHTML=`<b>${f.nom}</b> Â· ${f.w} Â· ${f.abs}`;
}

function updateHydraHint(v){
hydraHint.textContent=
v<=60?"ğŸŸ¢ Facile Ã  travailler":
v<=65?"ğŸŸ  Bon Ã©quilibre":
v<=70?"ğŸ”´ TrÃ¨s souple":
"ğŸ”¥ Expert only";
}
hydraSlider.oninput=()=>{hydratation.value=hydraSlider.value;updateHydraHint(+hydraSlider.value)}
hydratation.oninput=()=>{hydraSlider.value=hydratation.value;updateHydraHint(+hydratation.value)}

function updateEmpatement(){bigaOptions.classList.toggle("hidden",empatement.value!=="biga")}
function calculer(){
const f=farines[farine.value],four=fours[modeFour.value];
const total=pizzas.value*poids.value;
const hyd=(+hydratation.value+four.hydra)/100;
const sel=selPct.value/100;
const farineTot=total/(1+hyd+sel);
const eau=farineTot*hyd;
const selG=farineTot*sel;
let lev=farineTot*(0.002*f.coef);
if(typeLevure.value==="seche") lev*=.33;

fiche.textContent=
`ğŸ• PROTOCOLE FUN PIZZA

Farine : ${f.nom}
Hydratation : ${hydratation.value} %

Farine : ${farineTot.toFixed(1)} g
Eau : ${eau.toFixed(1)} g
Sel : ${selG.toFixed(1)} g
Levure : ${lev.toFixed(2)} g

Four : ${four.label}
TempÃ©rature : ${four.temp}

Ã€ moment donnÃ©â€¦ fais confiance Ã  la fermentation ğŸ˜‰`;
}

function exportPDF(){
const {jsPDF}=window.jspdf;
const pdf=new jsPDF();
pdf.text(fiche.textContent,10,10);
pdf.save("Pizza-Protocole.pdf");
}

changerFarine();
</script>
</body>
</html>
