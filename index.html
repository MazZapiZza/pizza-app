<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pizza App ‚Äì Dimitri V4</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Pizza App">

<style>
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;margin:0;padding:16px;background:#f2f2f7;color:#111}
.container{max-width:460px;margin:auto}
h1{text-align:center;margin-bottom:20px}
.card{background:#fff;border-radius:18px;padding:16px;margin-bottom:16px;box-shadow:0 8px 20px rgba(0,0,0,.08)}
label{font-weight:600;display:block;margin-bottom:6px}
select,input,button{width:100%;padding:12px;font-size:16px;border-radius:12px;border:1px solid #ccc}
button{background:#ff3b30;color:#fff;font-weight:bold;border:none;margin-top:8px}
pre{background:#1c1c1e;color:#0f0;padding:14px;border-radius:14px;font-size:13px;white-space:pre-wrap}
.small{font-size:13px;color:#666}
.star{font-size:22px;cursor:pointer}
</style>
</head>

<body>
<div class="container">
<h1>üçï Pizza App V4</h1>

<div class="card">
<label>Profil</label>
<select id="profil">
<option value="manuel" selected>Manuel</option>
<option value="ete">√ât√©</option>
<option value="hiver">Hiver</option>
</select>
</div>

<div class="card">
<label>Farine</label>
<select id="farine"></select>
<div id="farineInfo" class="small"></div>
</div>

<div class="card">
<label>Mode four</label>
<select id="modeFour">
<option value="bois">üî• Bois</option>
<option value="elec">‚ö° √âlectrique pro</option>
<option value="ooni">üî• Gaz Ooni</option>
</select>
</div>

<div class="card">
<label>Emp√¢tement</label>
<select id="empatement">
<option value="direct">Direct</option>
<option value="biga">Biga avanc√©e</option>
<option value="poolish">Poolish</option>
</select>

<label>% Biga (si activ√©e)</label>
<input type="number" id="bigaPct" value="50">
</div>

<div class="card">
<label>Fermentation (TA ‚Üí TC ‚Üí TA)</label>

<label>TA 1 (h / ¬∞C)</label>
<input type="number" id="ta1h" value="4">
<input type="number" id="ta1t" value="20">

<label>TC (h / ¬∞C)</label>
<input type="number" id="tcH" value="16">
<input type="number" id="tcT" value="4">

<label>TA 2 (h / ¬∞C)</label>
<input type="number" id="ta2h" value="4">
<input type="number" id="ta2t" value="20">
</div>

<div class="card">
<label>Levure</label>
<select id="typeLevure">
<option value="fraiche">Fra√Æche</option>
<option value="seche">S√®che</option>
</select>

<label>Gestion levure</label>
<select id="modeLevure">
<option value="auto">Auto (temp√©rature)</option>
<option value="manuel">Manuel</option>
</select>
</div>

<div class="card">
<label>Hydratation (%)</label>
<input type="number" id="hydratation" value="62">

<label>Nombre de pizzas</label>
<input type="number" id="pizzas" value="4">

<label>Poids p√¢ton (g)</label>
<input type="number" id="poids" value="280">
</div>

<button onclick="calculer()">Calculer</button>
<button onclick="ajouterFavori()">‚≠ê Favori</button>

<div class="card"><pre id="fiche"></pre></div>

<div class="card">
<h3>üìö Historique</h3>
<pre id="historique"></pre>
</div>

<div class="card">
<h3>‚≠ê Favoris</h3>
<pre id="favoris"></pre>
</div>
</div>

<script>
/* FARINES */
const farines={
caputo_pizzeria:{nom:"Caputo Pizzeria",w:"W260",abs:"55‚Äì60%",hydra:60,levure:1},
caputo_cuoco:{nom:"Caputo Cuoco",w:"W300",abs:"60‚Äì62%",hydra:62,levure:0.85},
caputo_nuvola:{nom:"Caputo Nuvola",w:"W280",abs:"63‚Äì65%",hydra:65,levure:0.9},
caputo_supernuvola:{nom:"Caputo Super Nuvola",w:"W320",abs:"68‚Äì70%",hydra:68,levure:0.8},
petra_0102:{nom:"Petra 0102 HP",w:"W300",abs:"63‚Äì65%",hydra:64,levure:0.9},
petra_integrale:{nom:"Petra Integrale",w:"W280",abs:"65‚Äì70%",hydra:70,levure:1.1},
denti_anima:{nom:"Denti Anima Verace",w:"W280",abs:"60‚Äì62%",hydra:62,levure:0.95}
};

/* FOURS */
const fours={
bois:{temp:"430‚Äì480 ¬∞C",temps:"60‚Äì90 s",hydra:+2},
elec:{temp:"420‚Äì450 ¬∞C",temps:"90‚Äì120 s",hydra:0},
ooni:{temp:"420‚Äì500 ¬∞C",temps:"60‚Äì120 s",hydra:+1}
};

/* INIT */
const farineSel=document.getElementById("farine");
Object.keys(farines).forEach(k=>{
const o=document.createElement("option");
o.value=k;o.textContent=farines[k].nom;
farineSel.appendChild(o);
});
changerFarine();
afficherHistorique();
afficherFavoris();

/* FARINE */
function changerFarine(){
const f=farines[farineSel.value];
hydratation.value=f.hydra;
document.getElementById("farineInfo").textContent=`${f.w} ¬∑ Absorption ${f.abs}`;
}

/* CALCUL */
function calculer(){
const f=farines[farineSel.value];
const four=fours[document.getElementById("modeFour").value];

let hyd=Number(hydratation.value)+four.hydra;
if(hyd<55) hyd=55;
hydratation.value=hyd;
hyd/=100;

const total=pizzas.value*poids.value;
const selPct=0.028;

const farineTot=total/(1+hyd+selPct);
const eau=farineTot*hyd;
const sel=farineTot*selPct;

/* Temp√©rature moyenne fermentation */
const hTot=+ta1h.value + +tcH.value + +ta2h.value;
const tMoy=(ta1t.value*ta1h.value + tcT.value*tcH.value + ta2t.value*ta2h.value)/hTot;

/* Levure */
let levBase=0.002*f.levure;
if(modeLevure.value==="auto") levBase*=20/tMoy;
let levure=farineTot*levBase;
if(typeLevure.value==="seche") levure*=0.33;

/* Pr√©parations */
let prepa="";
if(empatement.value==="biga"){
const fb=farineTot*(bigaPct.value/100);
prepa=`\nBIGA ${bigaPct.value}%\nFarine : ${fb.toFixed(1)} g\nEau : ${(fb*0.45).toFixed(1)} g\nLevure : ${(fb*0.001).toFixed(2)} g\n`;
}
if(empatement.value==="poolish"){
const fp=farineTot*0.5;
prepa=`\nPOOLISH\nFarine : ${fp.toFixed(1)} g\nEau : ${fp.toFixed(1)} g\nLevure : ${(fp*0.001).toFixed(2)} g\n`;
}

const txt=
`üçï PROTOCOLE V4

Farine : ${f.nom}
Four : ${document.getElementById("modeFour").selectedOptions[0].text}
Hydratation : ${(hyd*100).toFixed(1)} %

Fermentation totale : ${hTot} h
Temp√©rature moyenne : ${tMoy.toFixed(1)} ¬∞C

INGR√âDIENTS
Farine : ${farineTot.toFixed(1)} g
Eau : ${eau.toFixed(1)} g
Sel : ${sel.toFixed(1)} g
Levure ${typeLevure.value} : ${levure.toFixed(2)} g
${prepa}
CUISSON
Temp√©rature : ${four.temp}
Temps : ${four.temps}
`;

document.getElementById("fiche").textContent=txt;
sauverHistorique(txt);
}

/* HISTORIQUE */
function sauverHistorique(t){
let h=JSON.parse(localStorage.getItem("pizzaHist")||"[]");
h.unshift({date:new Date().toLocaleString(),txt:t});
localStorage.setItem("pizzaHist",JSON.stringify(h.slice(0,5)));
afficherHistorique();
}
function afficherHistorique(){
let h=JSON.parse(localStorage.getItem("pizzaHist")||"[]");
document.getElementById("historique").textContent=h.map(e=>`üìÖ ${e.date}\n${e.txt}`).join("\n---\n");
}

/* FAVORIS */
function ajouterFavori(){
let f=JSON.parse(localStorage.getItem("pizzaFav")||"[]");
f.unshift(document.getElementById("fiche").textContent);
localStorage.setItem("pizzaFav",JSON.stringify(f.slice(0,5)));
afficherFavoris();
}
function afficherFavoris(){
let f=JSON.parse(localStorage.getItem("pizzaFav")||"[]");
document.getElementById("favoris").textContent=f.join("\n---\n");
}
</script>
</body>
</html>
