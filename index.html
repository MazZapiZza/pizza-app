<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pizza App ‚Äì V6.3</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Pizza App">

<style>
:root{
  --bg:#f4f4f6;
  --card:#ffffff;
  --accent:#ff3b30;
  --text:#111;
  --muted:#666;
}
body.dark{
  --bg:#0f0f12;
  --card:#1c1c1e;
  --accent:#ff453a;
  --text:#f2f2f7;
  --muted:#aaa;
}
*{box-sizing:border-box}
body{
  margin:0;
  padding:16px;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.container{max-width:440px;margin:auto}
h1{text-align:center;margin-bottom:6px}
.subtitle{text-align:center;color:var(--muted);margin-bottom:16px;font-size:14px}
.card{
  background:var(--card);
  border-radius:16px;
  padding:16px;
  margin-bottom:14px;
  box-shadow:0 6px 16px rgba(0,0,0,.12);
}
.section-title{font-size:15px;font-weight:700;margin-bottom:10px}
label{font-size:14px;font-weight:600;margin-bottom:4px;display:block}
input,select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #444;
  font-size:15px;
  margin-bottom:10px;
  background:var(--card);
  color:var(--text);
}
input[type=range]{padding:0}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:700;
  background:var(--accent);
  color:#fff;
  cursor:pointer;
  margin-bottom:10px;
}
.toggle{text-align:right;font-size:13px;cursor:pointer;color:var(--muted)}
pre{
  background:#000;
  color:#0f0;
  padding:14px;
  border-radius:12px;
  font-size:13px;
  white-space:pre-wrap;
}
.small{font-size:13px;color:var(--muted)}
.hint{font-size:13px;color:var(--muted);margin-top:-6px}
</style>
</head>

<body>
<div class="container">

<div class="toggle" onclick="toggleDark()">üåô / ‚òÄÔ∏è Mode</div>

<h1>üçï Pizza App</h1>
<div class="subtitle">V6.3 ¬∑ Finale stable</div>

<!-- PROFIL -->
<div class="card">
<div class="section-title">Profil Pizza</div>
<select id="profil" onchange="appliquerProfil()">
<option value="maison">üè† Maison (libre)</option>
<option value="napo">üçï Napolitaine</option>
<option value="romaine">üçï Romaine</option>
<option value="teglia">üçï Teglia</option>
</select>
</div>

<!-- FARINE -->
<div class="card">
<div class="section-title">Farine</div>
<select id="farine" onchange="changerFarine()"></select>
<div id="farineInfo" class="small"></div>
</div>

<!-- HYDRATATION -->
<div class="card">
<div class="section-title">Hydratation</div>
<label>Hydratation (%)</label>
<input type="number" id="hydratation" min="55" max="80">
<input type="range" id="hydraSlider" min="55" max="80" step="1">
<div id="hydraHint" class="hint"></div>

<div class="grid-2">
<div><label>Pizzas</label><input type="number" id="pizzas" value="4"></div>
<div><label>P√¢ton (g)</label><input type="number" id="poids" value="280"></div>
</div>
</div>

<!-- FERMENTATION -->
<div class="card">
<div class="section-title">Fermentation</div>

<label>TA 1 ‚Äì Temp√©rature ambiante (h / ¬∞C)</label>
<div class="grid-2">
<input type="number" id="ta1h" value="4">
<input type="number" id="ta1t" value="20">
</div>

<label>TC ‚Äì Temp√©rature contr√¥l√©e (h / ¬∞C)</label>
<div class="grid-2">
<input type="number" id="tcH" value="16">
<input type="number" id="tcT" value="4">
</div>

<label>TA 2 ‚Äì Retour ambiant (h / ¬∞C)</label>
<div class="grid-2">
<input type="number" id="ta2h" value="4">
<input type="number" id="ta2t" value="20">
</div>
</div>

<!-- LEVURE & FOUR -->
<div class="card">
<div class="section-title">Levure & Four</div>

<select id="typeLevure">
<option value="fraiche">Levure fra√Æche</option>
<option value="seche">Levure s√®che</option>
</select>

<select id="modeLevure">
<option value="auto">Levure automatique</option>
<option value="manuel">Levure manuelle</option>
</select>

<select id="modeFour" onchange="updateFourHint()"></select>
<div id="fourHint" class="hint"></div>
</div>

<button onclick="calculer()">Calculer</button>
<button onclick="exportPDF()">üìÑ Export PDF</button>

<div class="card"><pre id="fiche"></pre></div>

<!-- GLOSSAIRE -->
<div class="card">
<div class="section-title">Glossaire</div>
<p class="small"><b>TA</b> : Temp√©rature ambiante (18‚Äì25 ¬∞C). Plus chaud = fermentation plus rapide.</p>
<p class="small"><b>TC</b> : Temp√©rature contr√¥l√©e (frigo 3‚Äì6 ¬∞C). Fermentation lente et ar√¥mes.</p>
<p class="small"><b>Hydratation</b> : Pourcentage d‚Äôeau par rapport √† la farine.<br>
60 % = facile ¬∑ 65 % = √©quilibr√© ¬∑ 70 %+ = tr√®s souple</p>
</div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
/* DARK MODE */
if(localStorage.getItem("dark")==="1") document.body.classList.add("dark");
function toggleDark(){
document.body.classList.toggle("dark");
localStorage.setItem("dark",document.body.classList.contains("dark")?"1":"0");
}

/* FARINES */
const farines={
caputo_pizzeria:{nom:"Caputo Pizzeria",w:"W260",abs:"55‚Äì60%",hydra:60,levure:1},
caputo_cuoco:{nom:"Caputo Cuoco",w:"W300",abs:"60‚Äì62%",hydra:62,levure:0.85},
caputo_nuvola:{nom:"Caputo Nuvola",w:"W280",abs:"63‚Äì65%",hydra:65,levure:0.9},
caputo_supernuvola:{nom:"Caputo Super Nuvola",w:"W320",abs:"68‚Äì70%",hydra:68,levure:0.8},
petra_0102:{nom:"Petra 0102 HP",w:"W300",abs:"63‚Äì65%",hydra:64,levure:0.9},
petra_integrale:{nom:"Petra Integrale",w:"W280",abs:"65‚Äì70%",hydra:70,levure:1.1},
denti_anima:{nom:"Denti Anima Verace",w:"W280",abs:"60‚Äì62%",hydra:62,levure:0.95}
};

/* FOURS */
const fours={
bois:{label:"üî• Bois",hydra:+2,temp:"430‚Äì480 ¬∞C",temps:"60‚Äì90 s",txt:"Chaleur tr√®s vive"},
elec:{label:"‚ö° √âlectrique",hydra:0,temp:"420‚Äì450 ¬∞C",temps:"90‚Äì120 s",txt:"Chaleur stable"},
ooni:{label:"üî• Gaz Ooni",hydra:+1,temp:"420‚Äì500 ¬∞C",temps:"60‚Äì120 s",txt:"Chaleur forte"}
};

/* INIT */
Object.keys(farines).forEach(k=>{
const o=document.createElement("option");
o.value=k;o.textContent=farines[k].nom;
farine.appendChild(o);
});
Object.keys(fours).forEach(k=>{
const o=document.createElement("option");
o.value=k;o.textContent=fours[k].label;
modeFour.appendChild(o);
});
changerFarine();updateFourHint();

/* FARINE */
function changerFarine(){
const f=farines[farine.value];
hydratation.value=f.hydra;
hydraSlider.value=f.hydra;
updateHydraHint(f.hydra);
farineInfo.innerHTML=`<b>${f.nom}</b><br>Force : ${f.w} ¬∑ Hydratation conseill√©e : ${f.abs}`;
}

/* HYDRATATION UX */
function updateHydraHint(v){
if(v<=60) hydraHint.textContent="P√¢te facile";
else if(v<=65) hydraHint.textContent="Bon √©quilibre";
else if(v<=70) hydraHint.textContent="Tr√®s souple";
else hydraHint.textContent="Tr√®s technique";
}
hydraSlider.oninput=()=>{hydratation.value=hydraSlider.value;updateHydraHint(+hydraSlider.value);}
hydratation.oninput=()=>{hydraSlider.value=hydratation.value;updateHydraHint(+hydratation.value);}

/* FOUR */
function updateFourHint(){fourHint.textContent=fours[modeFour.value].txt;}

/* PROFILS */
const profils={
napo:{hydra:62,ta1h:6,tcH:16,ta2h:2,four:"ooni"},
romaine:{hydra:58,ta1h:8,tcH:24,ta2h:4,four:"elec"},
teglia:{hydra:75,ta1h:4,tcH:24,ta2h:4,four:"elec"}
};
function appliquerProfil(){
const p=profils[profil.value];
if(!p) return;
hydratation.value=p.hydra;
hydraSlider.value=p.hydra;
ta1h.value=p.ta1h;
tcH.value=p.tcH;
ta2h.value=p.ta2h;
modeFour.value=p.four;
updateHydraHint(p.hydra);
updateFourHint();
}

/* CALCUL */
function calculer(){
const f=farines[farine.value];
const four=fours[modeFour.value];
const hydUser=+hydratation.value;
const hydCalc=(hydUser+four.hydra)/100;
const total=pizzas.value*poids.value;
const selPct=0.028;

const farineTot=total/(1+hydCalc+selPct);
const eau=farineTot*hydCalc;
const sel=farineTot*selPct;

const hTot=+ta1h.value + +tcH.value + +ta2h.value;
const tMoy=(ta1t.value*ta1h.value + tcT.value*tcH.value + ta2t.value*ta2h.value)/hTot;

let levBase=0.002*f.levure;
if(modeLevure.value==="auto") levBase*=20/tMoy;
let levure=farineTot*levBase;
if(typeLevure.value==="seche") levure*=0.33;

fiche.textContent=
`üçï PROTOCOLE V6.3

Farine : ${f.nom} (${f.w})
Hydratation : ${hydUser} %

INGR√âDIENTS
Farine : ${farineTot.toFixed(1)} g
Eau : ${eau.toFixed(1)} g
Sel : ${sel.toFixed(1)} g
Levure : ${levure.toFixed(2)} g

FERMENTATION
Dur√©e : ${hTot} h
Temp√©rature moyenne : ${tMoy.toFixed(1)} ¬∞C

CUISSON
Four : ${four.label}
Temp√©rature : ${four.temp}
Temps : ${four.temps}`;
}

/* PDF */
function exportPDF(){
const { jsPDF } = window.jspdf;
const pdf = new jsPDF();
pdf.text(fiche.textContent,10,10);
pdf.save("Pizza-Protocole.pdf");
}
</script>
</body>
</html>
